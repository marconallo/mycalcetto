{"ts":1350981784799,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\r\n\r\ndefine('INCLUDE_CHECK',true);\r\n// Those files can be included only if INCLUDE_CHECK is defined\r\nrequire_once 'user_access/connect.php';\r\nrequire_once 'user_access/functions.php';\r\nrequire_once 'functions_partite.php';\r\nrequire_once 'functions_user.php';\r\n\r\n// Starting the session\r\nsession_name('tzLogin');\r\nsession_set_cookie_params(2*7*24*60*60);\r\nsession_start();\r\n\r\nif(!isset($_SESSION['id'])) {\r\n\theader(\"Location: index.php\");\r\n\texit;\r\n}\r\n\r\nif(isset($_SESSION['id']) && !isset($_COOKIE['myCalcettoID']) && !$_SESSION['rememberMe']){\r\n\t// If you are logged in, but you don't have the tzRemember cookie (browser restart)\r\n\t// and you have not checked the rememberMe checkbox:\r\n\r\n\t// Destroy the session\r\n\t$_SESSION = array();\r\n\tsession_destroy();\r\n}\r\n\r\nif(isset($_GET['logoff'])){\r\n\t$_SESSION = array();\r\n\tsession_destroy();\r\n\tsetcookie('myCalcettoID','',-1);\r\n\tsetcookie('myCalcettoUSR','',-1);\r\n\t\r\n\theader(\"Location: index.php\");\r\n\texit;\r\n}\r\n$script = '';\r\n\r\nif($_SESSION['msg']){\r\n\t// The script below shows the sliding panel on page load\r\n\t$script = '\r\n\t<script type=\"text/javascript\">\r\n\t\t$(function(){\r\n\t\t\t$(\"div#panel\").show();\r\n\t\t\t$(\"#toggle a\").toggle();\r\n\t\t});\r\n\t</script>';\r\n}\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n<title>MyCalcetto</title>\r\n    \r\n    <!-- Files START-->\r\n\t<?php include 'script/files.php'; ?>\r\n\t<!-- Files END-->\r\n    <?php echo $script; ?>\r\n    <script type=\"text/javascript\" src=\"js/jquery.validate.js\"></script>\r\n    <script type=\"text/javascript\">\r\n\t\t\t\t\r\n    \r\n    \t$(document).ready(function() {\r\n    \t\tvar userForm = $(\"#userForm\").validate({\r\n\t\t\t\trules: {\r\n\t\t\t\t\tnome: {required: true},\r\n\t\t\t\t\tcognome: {required: true},\r\n\t\t\t\t\temail: {required: true, email: true}\r\n\t\t\t\t},\r\n\t\t\t\tmessages: {\r\n\t\t\t\t\tnome: \"Campo obbligatorio\",\r\n\t\t\t\t\tcognome: \"Campo obbligatorio\",\r\n\t\t\t\t\temail: \"Inserisci un indirizzo e-mail valido\"\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t$(\"#passForm\").validate({\r\n\t\t\t\trules: {\r\n\t\t\t\t\toldPassword: {required: true},\r\n\t\t\t\t\tnewPassword: {required: true},\r\n\t\t\t\t\tnewPasswordConfirm: {required: true, equalTo: \"#newPassword\"}\r\n\t\t\t\t},\r\n\t\t\t\tmessages: {\r\n\t\t\t\t\toldPassword: \"Campo obbligatorio\",\r\n\t\t\t\t\tnewPassword: \"Campo obbligatorio\",\r\n\t\t\t\t\tnewPasswordConfirm: {\r\n\t\t\t\t\t\trequired: \"Campo obbligatorio\",\r\n\t\t\t\t\t\tequalTo: \"La due password devono essere uguali\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n    \t\t$('input').click(function() {\r\n            \tthis.focus();\r\n            \tthis.select();\r\n        \t});\r\n\r\n        \t$('#resetUserForm').click(function(){\r\n        \t\tuserForm.resetForm();\r\n        \t});\r\n\r\n        });\r\n    \tfunction modUser(){\r\n    \t\tdocument.body.style.cursor = 'wait';\r\n\t    \tvar options = { beforeSubmit: checkUserForm, target:'#output', success:showResponse}; \r\n\t\t   \t$(\"#userForm\").ajaxSubmit(options);\r\n\t       \tdocument.body.style.cursor = 'default';\r\n    \t}\r\n    \tfunction modPass(){\r\n    \t\tdocument.body.style.cursor = 'wait';\r\n    \t\tvar options = { beforeSubmit: checkPassForm, target:'#output', success:showResponse}; \r\n\t\t   \t$(\"#passForm\").ajaxSubmit(options);\r\n\t       \tdocument.body.style.cursor = 'default';\r\n    \t}\r\n\r\n    \t// pre-submit  \r\n        function checkUserForm()  {\r\n        \treturn $('#userForm').validate().form();\r\n        }\r\n\r\n        function checkPassForm()  {\r\n        \treturn $('#passForm').validate().form();\r\n        }\r\n    \t\r\n    \t// post-submit callback \r\n        function showResponse(responseText, statusText, xhr, $form)  {\r\n            $.colorbox({\r\n                inline:true, \r\n                href:\"#output\",\r\n                onCleanup:function(){ location.reload(); }\r\n            });\r\n        }\r\n         \r\n        \r\n    </script>\r\n</head>\r\n\r\n<body>\r\n<div style=\"display: none;\">\r\n<div id=\"output\"></div>\r\n</div>\r\n<!-- Panel START-->\r\n<?php include 'script/panel.php'; ?>\r\n<!-- Panel END-->\r\n\r\n<div class=\"pageContent\">\r\n\t<div id=\"main\">\r\n\t\t<?php \r\n\t\tif(isset($_SESSION['id'])) {\r\n\t\t\t$user = $_SESSION['id'];\r\n\t\t?>\r\n\t\t<div class=\"container\">\r\n\t\t\t<?php include 'script/menu.php'; ?>\r\n\t        <h1>Modifica i dati</h1>\r\n        </div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<h3></h3>\r\n\t\t\t<?php visualizzaUtente($_SESSION['id'], false)?>\r\n\t\t</div>\r\n        \r\n<?php } else { ?>\r\n\theader(\"Location: index.php\");\r\n<?php }?>\r\n      \t<div class=\"container tutorial-info\">\r\n     \t\tPowered by <strong>Mako'</strong>.    \r\n     \t</div>\r\n\t</div>\r\n</div>\r\n\r\n</body>\r\n</html>"]],"start1":0,"start2":0,"length1":0,"length2":4406}]],"length":4406}
{"contributors":[],"silentsave":false,"ts":1350982254641,"patch":[[{"diffs":[[0,">';\r\n}\r\n"],[1,"\r\nif (isset($_SESSION['level']) && $_SESSION['level']==9) {\r\n    $isAdmin=true;\r\n}\r\n\r\n"],[0,"?>\r\n\r\n<!"]],"start1":1193,"start2":1193,"length1":16,"length2":102},{"diffs":[[0,"'], "],[-1,"false"],[1,"$isAdmin"],[0,")?>\r"]],"start1":4253,"start2":4253,"length1":13,"length2":16}]],"length":4495,"saved":false}
